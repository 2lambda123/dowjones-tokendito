name: Docker Image CI

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    
    - name: Docker Setup QEMU
      uses: docker/setup-qemu-action@v2.0.0
      with:
        # QEMU static binaries Docker image (e.g. tonistiigi/binfmt:latest)
        # image: # optional, default is tonistiigi/binfmt:latest
        # Platforms to install (e.g. arm64,riscv64,arm)
        platforms: # optional, default is all
    

    - name: Docker Login
      uses: docker/login-action@v2.0.0
      with:
        registry: # optional
        # Username used to log against the Docker registry
        username: # optional
        # Password or personal access token used to log against the Docker registry
        password: # optional
        # Specifies whether the given registry is ECR (auto, true or false)
        ecr: # optional, default is auto
        # Log out from the Docker registry at the end of a job
        logout: # optional, default is true


    - name: Docker Setup Buildx
      # You may pin to the exact commit or the version.
      uses: docker/setup-buildx-action@v2.0.0
      with:
        # Buildx version. (eg. v0.3.0)
        version: # optional
        # Sets the builder driver to be used
        driver: # optional, default is docker-container
        # List of additional driver-specific options. (eg. image=moby/buildkit:master)
        driver-opts: # optional
        # Flags for buildkitd daemon
        buildkitd-flags: # optional, default is --allow-insecure-entitlement security.insecure --allow-insecure-entitlement network.host
        # Sets up docker build command as an alias to docker buildx
        install: # optional, default is false
        # Switch to this builder instance
        use: # optional, default is true
        # Optional address for docker socket or context from `docker context ls`
        endpoint: # optional
        # BuildKit config file
        config: # optional
        # Inline BuildKit config
        config-inline: # optional      
    
